(()=>{"use strict";const e=(e,t,n)=>{switch(e=Number(e),n=Number(n),t){case"+":return function(e,t){return e+t}(e,n);case"-":return function(e,t){return e-t}(e,n);case"*":return function(e,t){return e*t}(e,n);case"/":return 0==n?null:function(e,t){return e/t}(e,n);default:return}},t=(e,t,...n)=>{const r=document.createElement(e);for(let e in t)r.setAttribute(e,t[e]);return n.forEach((e=>{"string"==typeof e?r.appendChild(document.createTextNode(e)):r.appendChild(e)})),r},n=[{left:[1,"+","?"],right:[1,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:["?","-","5"],right:[2,"*","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}],r=(()=>{const e=document.querySelector("#app"),n=document.querySelector(".game-left"),r=document.querySelector(".equation-wrapper"),i=document.querySelector("#tiles"),o=document.querySelector(".buttons-wrapper"),s=document.querySelector("#score"),u=document.querySelector("#time");return{renderGameUI:()=>{e.appendChild(gameUI())},renderTiles:(e,t,n)=>{const r=(e,t,n,r)=>{const o=document.createElement("div");o.classList.add("tile"),o.textContent=e,o.dataset.index=t,i.appendChild(o),o.addEventListener(n,(e=>{r(e)}))};for(let i=0;i<e.length;i++)r(e[i],i,t,n)},deactivateTiles:()=>{tilesHtml.querySelectorAll(".tile").forEach((e=>{e.replaceWith(e.cloneNode(!0))}))},renderEquation:(e,n)=>{const i=(e,n)=>{const i=t("div",{class:"equation-value"},String(e));"string"==typeof e&&(e.search(/[\+\-*\/]/)||i.classList.add("operator"),"="==e&&i.classList.add("equals"),1==n&&i.classList.add("in-focus")),r.appendChild(i)};for(let t=0;t<e.length;t++)i(e[t],t==n)},updateEquation:(e,t)=>{const n=r.childNodes;e.forEach(((e,r)=>{n[r].textContent!=e&&(n[r].textContent=e),r==t?n[r].classList.add("in-focus"):n[r].classList.remove("in-focus")}))},renderSubmitBtn:e=>{o.querySelector("#submit")&&o.removeChild(o.querySelector("#submit"));const n=t("div",{id:"submit",class:"btn submit"},"Submit");n.addEventListener("click",e),o.appendChild(n)},renderUndoBtn:e=>{o.querySelector("#undo")&&o.removeChild(o.querySelector("#undo"));const n=t("div",{id:"undo",class:"btn undo"},"Undo");n.addEventListener("click",e),o.appendChild(n)},resetGameUI:()=>{r.innerHTML="",o.innerHTML="",i.innerHTML=""},setScore:e=>{s.innerHTML=e},setTime:e=>{const t=Math.floor(e/6e4),n=e%6e4/1e3;u.textContent=`Time: ${t}:${String(n).padStart(2,"0")}`},renderPopup:(e,r)=>{const i=t("div",{class:"button"},"Play Again?"),o=t("div",{class:"popup-wrapper"},e,i);i.addEventListener("click",(()=>{r(),n.removeChild(o)})),n.appendChild(o)}}})();function i(t,s,u){const c=100*s,a=((t,n)=>{const{left:r,right:i,tiles:o}=t,s=[...r,"=",...i],u=s.reduce(((e,t,n)=>("?"===t&&e.push(n),e)),[]);let c=0;return setInterval((()=>{n-=1e3}),1e3),{tiles:o,equation:s,getCurrentMissingValue:()=>u[c],getTime:()=>n,updateEquation:e=>{if(c>=u.length)return;const t=(e=>{const t=e.target.dataset.index;return o[t]})(e);s[u[c]]=t,c++},undo:()=>{c<=0||(s[u[c-1]]="?",c--)},checkEquation:()=>{const t=s.slice(0,3),n=s.slice(4,7);return e(...t)===e(...n)}}})(t[s],u);r.resetGameUI();let d=setInterval((()=>{const e=a.getTime();r.setTime(e),e<=0&&o("Game Over. Score",d,c)}),1e3);r.setScore(c),r.renderEquation(a.equation,a.getCurrentMissingValue()),r.renderTiles(a.tiles,"click",(e=>{a.updateEquation(e),r.updateEquation(a.equation,a.getCurrentMissingValue())})),r.renderSubmitBtn((e=>{if(!(a.checkEquation(e)&&s<n.length-1))return a.checkEquation(e)&&s==n.length-1?void o("You Win! Score",d,c):void o("Game Over. Score",d,c);s++,clearInterval(d),i(t,s,a.getTime()+4e3)})),r.renderUndoBtn((()=>{a.undo(),r.updateEquation(a.equation,a.getCurrentMissingValue())}))}function o(e,t,o){r.resetGameUI(),r.renderPopup(`${e}: ${o}`,(()=>{i(n,0,6e4)})),clearInterval(t)}i(n,0,6e4)})();