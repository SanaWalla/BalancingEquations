(()=>{"use strict";const e=(e,t,r)=>{switch(e=Number(e),r=Number(r),t){case"+":return function(e,t){return e+t}(e,r);case"-":return function(e,t){return e-t}(e,r);case"*":return function(e,t){return e*t}(e,r);case"/":return 0==r?null:function(e,t){return e/t}(e,r);default:return}},t=(e,t,...r)=>{const n=document.createElement(e);for(let e in t)n.setAttribute(e,t[e]);return r.forEach((e=>{"string"==typeof e?n.appendChild(document.createTextNode(e)):n.appendChild(e)})),n},r=[{left:[1,"+","?"],right:[1,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:[5,"-","?"],right:[3,"+","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]},{left:["?","-","5"],right:[2,"*","?"],tiles:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14]}],n=(()=>{const e=document.querySelector("#app"),r=document.querySelector(".game-left"),n=document.querySelector(".equation-wrapper"),a=document.querySelector("#tiles"),i=document.querySelector(".buttons-wrapper"),s=document.querySelector("#score"),o=document.querySelector("#time"),l=document.querySelector(".avatar-wrapper");return{renderGameUI:()=>{e.appendChild(gameUI())},renderTiles:(e,t,r)=>{const n=(e,t,r,n,i)=>{const s=document.createElement("div");s.classList.add("tile"),s.textContent=e,s.dataset.index=t,s.style.backgroundImage=`url('../../dist/img/tiles/Tile${r}.svg')`,a.appendChild(s),s.addEventListener(n,(e=>{i(e)}))};for(let a=0;a<e.length;a++)n(e[a],a,Math.floor(5*Math.random()+1),t,r)},deactivateTiles:()=>{tilesHtml.querySelectorAll(".tile").forEach((e=>{e.replaceWith(e.cloneNode(!0))}))},renderEquation:(e,r)=>{const a=(e,r)=>{const a=t("div",{class:"equation-value"},String(e));"string"==typeof e&&(e.search(/[\+\-*\/]/)||a.classList.add("operator"),"="==e&&a.classList.add("equals"),1==r&&a.classList.add("in-focus")),n.appendChild(a)};for(let t=0;t<e.length;t++)a(e[t],t==r)},updateEquation:(e,t)=>{const r=n.childNodes;e.forEach(((e,n)=>{r[n].textContent!=e&&(r[n].textContent=e),n==t?r[n].classList.add("in-focus"):r[n].classList.remove("in-focus")}))},renderAvatar:e=>{null!=l.querySelector(".avatar")&&l.removeChild(l.querySelector(".avatar")),0===e&&(e=1);const r=t("img",{class:"avatar",src:"../dist/img/avatar/avatar1.png"});e<3&&(r.src="../dist/img/avatars/avatar1.png"),e<6&&e>=3&&(r.src="../dist/img/avatars/avatar2.png"),e<9&&e>=6&&(r.src="../dist/img/avatars/avatar3.png"),e>=9&&(r.src="../dist/img/avatars/avatar4.png"),l.appendChild(r)},addPizza:e=>{const r=Math.floor(6*Math.random())+1,n=t("img",{class:"pizza",src:`../dist/img/pizza/pizza${r}.png`});n.style.bottom=1===e?"136px":136+14*(e-1)+"px",l.appendChild(n)},dropPizza:e=>{l.querySelectorAll(".pizza").forEach(((e,t)=>{const r=Math.floor(13*Math.random());setInterval((()=>{e.style.transform=`rotate(${r}deg) translateY(${136+14*t}px)`}),900-60*t)}))},renderSubmitBtn:e=>{i.querySelector("#submit")&&i.removeChild(i.querySelector("#submit"));const r=t("div",{id:"submit",class:"btn submit"},"Submit");r.addEventListener("click",e),i.appendChild(r)},renderUndoBtn:e=>{i.querySelector("#undo")&&i.removeChild(i.querySelector("#undo"));const r=t("div",{id:"undo",class:"btn undo"},"Undo");r.addEventListener("click",e),i.appendChild(r)},resetGameUI:(e=!1)=>{n.innerHTML="",i.innerHTML="",a.innerHTML="",!0===e&&l.querySelectorAll(".pizza").forEach((e=>{l.removeChild(e)}))},setScore:e=>{s.innerHTML=e},setTime:e=>{const t=Math.floor(e/6e4),r=e%6e4/1e3;o.textContent=`Time: ${t}:${String(r).padStart(2,"0")}`},renderPopup:(e,n)=>{const a=t("div",{class:"button"},"Play Again?"),i=t("div",{class:"popup-wrapper"},e,a);a.addEventListener("click",(()=>{n(),r.removeChild(i)})),r.appendChild(i)}}})();function a(t,s,o){const l=100*s,c=((t,r)=>{const{left:n,right:a,tiles:i}=t,s=[...n,"=",...a],o=s.reduce(((e,t,r)=>("?"===t&&e.push(r),e)),[]);let l=0;return setInterval((()=>{r-=1e3}),1e3),{tiles:i,equation:s,getCurrentMissingValue:()=>o[l],getTime:()=>r,updateEquation:e=>{if(l>=o.length)return;const t=(e=>{const t=e.target.dataset.index;return i[t]})(e);s[o[l]]=t,l++},undo:()=>{l<=0||(s[o[l-1]]="?",l--)},checkEquation:()=>{const t=s.slice(0,3),r=s.slice(4,7);return e(...t)===e(...r)}}})(t[s],o);n.resetGameUI(!1);let d=setInterval((()=>{const e=c.getTime();n.setTime(e),e<=0&&i("Game Over. Score",d,l)}),1e3);n.setScore(l),n.renderAvatar(s),n.renderEquation(c.equation,c.getCurrentMissingValue()),n.renderTiles(c.tiles,"click",(e=>{c.updateEquation(e),n.updateEquation(c.equation,c.getCurrentMissingValue())})),n.renderSubmitBtn((e=>{if(!(c.checkEquation(e)&&s<r.length-1))return c.checkEquation(e)&&s==r.length-1?void i("You Win! Score",d,l):(n.dropPizza(),void i("Game Over. Score",d,l));s++,n.addPizza(s),clearInterval(d),a(t,s,c.getTime()+4e3)})),n.renderUndoBtn((()=>{c.undo(),n.updateEquation(c.equation,c.getCurrentMissingValue())}))}function i(e,t,i){n.resetGameUI(),n.renderPopup(`${e}: ${i}`,(()=>{n.resetGameUI(!0),a(r,0,6e4)})),clearInterval(t)}a(r,0,6e4)})();